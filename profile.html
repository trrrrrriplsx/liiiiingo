<!DOCTYPE html>
<html lang="en">
<head>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
        const firebaseConfig = {
            apiKey: "AIzaSyCC0FbBPK4V7EMfkr0xty9Qc9Ck-cLu18s",
            authDomain: "lingoflow-c169e.firebaseapp.com",
            projectId: "lingoflow-c169e",
            storageBucket: "lingoflow-c169e.firebasestorage.app",
            messagingSenderId: "542175265484",
            appId: "1:542175265484:web:2723ae3b6f2558f034b869"
        };
        const app = initializeApp(firebaseConfig);
    </script>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Profile — LingoFlow</title>
    <link rel="stylesheet" href="css/style.css" />
</head>
<body>
  <div class="empty"></div>
  <nav>
    <a href="index.html" class="btn">Back to main</a>
    <a href="practice.html" class="btn">Go to practice</a>
  </nav>
  <div class="form-container">
    <h2>Welcome, <span id="username">Guest</span>!</h2>
    <p>Your progress will be shown here as you practice.</p>

    <!-- Статистика -->
    <div class="stats">
      <h3>Your Statistics</h3>
      <p>Total attempts: <span id="total-attempts">0</span></p>
      <p>Correct answers: <span id="correct-answers">0</span></p>
      <p>Success rate: <span id="success-rate">0%</span></p>
    </div>

    <!-- Кнопка сброса статистики -->
    <button class="reset-stats-btn" onclick="resetStats()">Reset Statistics</button>
  </div>

  <script type="module">
    import { auth, loadUserData, getUsername, resetStats, currentUser } from "./js/firebase.js";

    document.addEventListener("DOMContentLoaded", async () => {
      // Проверяем currentUser напрямую, а не window.currentUser
      if (!currentUser) {
        document.getElementById("username").textContent = "Guest";
        return;
      }
      const userData = await loadUserData();
      if (userData) {
        document.getElementById("username").textContent = getUsername();
        document.getElementById("total-attempts").textContent = userData.stats.total;
        document.getElementById("correct-answers").textContent = userData.stats.correct;
        const successRate = userData.stats.total > 0 ? Math.round((userData.stats.correct / userData.stats.total) * 100) : 0;
        document.getElementById("success-rate").textContent = `${successRate}%`;
      }
    });

    window.resetStats = resetStats; // Для кнопки
  </script>
</body>
</html>